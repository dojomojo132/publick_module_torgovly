Процедура УдалениеДокумента(Ссылка) Экспорт 
	
	Док = Ссылка.ПолучитьОбъект();
	Док.Удалить();

КонецПроцедуры

Процедура ОбновитьДокументПоСтруктуре(СтруктураДанных, ДокументСсылка) Экспорт
	Если ЗначениеЗаполнено(ДокументСсылка) = Ложь Тогда
		Возврат;
	КонецЕсли;
	// Получаем объект документа
    ДокументОбъект = ДокументСсылка.ПолучитьОбъект();
    
    // Флаг для отслеживания изменений
    БылиИзменения = Ложь;
    
    // Сравниваем поля структуры с полями документа
    Для Каждого ЭлементСтруктуры Из СтруктураДанных Цикл
        ИмяПоля = ЭлементСтруктуры.Ключ;
        НовоеЗначение = ЭлементСтруктуры.Значение;
        
        // Проверяем, есть ли такое поле в документе
        Если ДокументОбъект.Метаданные().Реквизиты.Найти(ИмяПоля) <> Неопределено Тогда
            // Сравниваем текущее значение с новым
            Если ДокументОбъект[ИмяПоля] <> НовоеЗначение Тогда
                ДокументОбъект[ИмяПоля] = НовоеЗначение;
                БылиИзменения = Истина;
            КонецЕсли;
        Иначе
            //Сообщить("Поле " + ИмяПоля + " не найдено в метаданных документа!", СтатусСообщения.Внимание);
        КонецЕсли;
    КонецЦикла;
    
    // Если были изменения, записываем документ
    Если БылиИзменения Тогда
        Попытка
            ДокументОбъект.Записать();
            Сообщить("Документ успешно обновлен.");
        Исключение
            Сообщить("Ошибка при записи документа: " + ОписаниеОшибки(), СтатусСообщения.Важное);
        КонецПопытки;
    Иначе
        Сообщить("Изменений в данных не обнаружено.");
    КонецЕсли;
    
КонецПроцедуры
